# OWASP Top 10 API

![](c4d6627-72c6-cba4-cded-3e8e64462f_27.jpg)

| No. | Name | Simple Description |
| ---- | ---- | ---- |
| 1 | Broken Object Level Authorization | manipulating IDs to impersonate other users and access data |
| 2 | Broken Authentication | Missing security controls Poorly implemented controls |
| 3 | Broken Object Property Level Authorization | Ability to update object elements and Revealing unnecessary sensitive data  |
| 4 | Unrestricted Resource Consumption  | Abuse of APIs due to high volumes of API calls, large requests, etc. (bruteforce) |
| 5 | Broken Function Level Authorization  | improperly modify objects from GET to PUT,DELETE |
| 6 | Unrestricted Access to Sensitive Business Flows  | Abuse of a legitimate business workflow through excessive, **automated** use |
| 7 | Server Side Request Forgery | Exploiting URL inputs to make a request to a malicious, 3rd party server |
| 8 | Security Misconfiguration  | lack of hardening to unnecessary services Use Of bots to scan, detect and exploit misconfigurations |
| 9 | Improper Inventory Management | Unauthorized API access via old, unused API versions, or through trusted 3rd parties. |
| 10 | Unsafe Consumption of APIs |  |

## 1.Broken Object Level Authorization

This involves manipulating IDs and gaining access to records that do not belong to you. And as you've seen, this can lead to data loss, data manipulation, and disclosure.

*Involves manipulating IDs to impersonate other users and access data.* 

Common issue because servers usually do not track client's state â€” relies on object IDs to determine authorization.

**Example:**
Attacker authenticates as User A and then retrieves data on User B.

**Risk Exposure**
Can lead to data loss, disclosure, data manipulation

**Prevention:**
Define data access policies and implement associated controls. Ensure authenticated user is authorized to requested data.

## 2.Broken Authentication

Weak or poor authentication creates vulnerability:
1. Missing security controls
2. Poorly implemented controls

**Risk Exposure:**
Attackers can gain control of users' accounts. Theft of data. Unauthorized transactions.

**Examples:**
Weak password requirements Credential stuffing: brute force ID/PW No captcha/rate limiting/lockout Auth info in URLs (tokens, passwords) Changing passwords w/o verification Non-validation of token authenticity Non-validation of JWT expiration
Insecure password storage 

**Prevention:**
Define authentication policies and standards; follow best practices

## 3.Broken Object Property Level Authorization

Exploit of endpoints by reading and/or modifying values of objects 

Ability to update object elements ("mass assignment ')

Revealing unnecessary sensitive data ("excessive data exposure")

**Risk Exposure:**
Revealing protected user data

**Examples:**
User is able to set "account-type=premium" User search endpoint returns excessive, unnecessary details (name, email, address, ID, ...)

**Prevention:**
Ensure user can only access
legitimate, permitted fields.
Return only minimum amount of
data required for the use case.

## 4.Unrestricted Resource Consumption 

Abuse of APIs due to high volumes of API calls, large requests, etc.

**Risk Exposure:**
Denial of service
Performance impact
Mass Data Harvesting

**Examples:**
Missing/inadequate rate controls
Execution timeouts
Max allocable memory
Max number of files, upload size
Excessive operations in single request
Excessive records returned in single request

**Prevention:**
Implement traffic controls.
Test effectiveness of controls.


## 5.Broken Function Level Authorization 

Abuse of API functionality to improperly modify objects (create, update, delete) Often involves replacing passive methods (GET) with active (PUT, DELETE)

**Risk Exposure:**
May be used to escalate privilege
Can be exploited to modify account details

**Examples:**
Modify parameters - "role = admin"
Delete an invoice
Set account balance = $0
**Prevention:**

Identify functions that expose high
sensitivity capability and develop
controls to limit access.
Implement continuous release
testing to ensure proper behavior.

## 6.Unrestricted Access to Sensitive Business Flows 

Abuse of a legitimate business workflow through excessive, automated use 
Rate limiting, captchas not always effective against fraudulent traffic 
Rapid IP rotation makes detection difficult
Typically a result of application logic flaw

**Risk Exposure:**
Loss of critical business activity

**Examples:**
Mass, automated ticket purchasing
High volume referral bonuses

**Prevention:**
Identify critical business workflows.
Implement fraudulent traffic detection and control.
Setup and automate testing of control mechanisms.

## 7.Server Side Request Forgery 

Exploiting URL inputs to make a request to a malicious, 3rd party server

**Risk Exposure:**
SSRF creates a channel for malicious requests, data access or other fraudulent activity

Potential for data leaks

**Examples:**
Local file injection (LFI)

User submits:
http://localhost/api/user-data

Malware downloaded from malicious site

**Prevention:**
Validate and sanitize ALL user-supplied information, including URL parameters.
Ensure communication only permitted with trusted resources.
Test URL validation effectiveness.

## 8.Security Misconfiguration 

Broad category encompasses lack of hardening to unnecessary services Use Of bots to scan, detect and exploit misconfigurations

**Risk Exposure:**
Misconfigurations can expose sensitive user data

Potential for full server compromise

**Examples:**
Lack of security hardening
Improperly configured permissions
Missing security patches
Unnecessary features enabled
Missing TLS
CORS policy missing/improperly set

**Prevention:**
Implement hardening procedures
Routinely review configurations
Implement automated, continuous security testing

## 9.Improper Inventory Management 

Unauthorized API access via old, unused API versions, or through trusted 3rd parties.

**Risk Exposure:**
Data/account theft via unretired APIs.
Exposure of sensitive data via
improperly secured 3rd party APIs.

**Examples:**
Old versions of APIs
Unpatched endpoints
Endpoints with weaker security requirements
API access through 3rd party
Outdated documentation
Unnecessarily exposed endpoints

**Prevention:**
Enforce a strict policy for deploying all APIs (in a gateway).
Implement rules and processes for API versioning and retirement.
Periodically audit 3rd party API access and ensure satisfactory protection.

## 10.Unsafe Consumption of APIs 

Exposures can occur via use of 3rd party APIs, which are generally trusted. However, 3rd parties can be exploited, which can be used to attack APIs that rely on them.

**Risk Exposure:**
Data theft, breach, account takeover

**Examples:**
Attacker inserts malicious data to address validation site used by Client. Attacker submits request to Client to specifically pull exploited data from 3rd party. Client
fails to validate data and gets exploited.

Attacker compromises 3rd party API causing it to respond with redirect to malicious site. Client blindly follows redirects without validation.

**Prevention:**
Evaluate security controls of 3rd party API.
Validate data returned by 3rd party APIs.
Encrypt all API communication.
Maintain approved list of known locations integrated APIs may be redirected.